<div class="container">
<h1 style="font-family: 'Times New Roman'" class="text-center">Carga Masiva</h1>
<h5>Seleccione archivo </h5>
<hr />

@using(Html.BeginForm("Carga", "CargaMasiva", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
        <input type="file" class="form-control" name="csv" id="csv" onchange="validateFile()" />

    <br />
    <div class="row g-3">
        <div class="col-md-1">
                <a><input type="submit" value="Insertar" class="btn btn-success" /></a>
            <br />
        </div>
    </div>
}
</div>
@section Scripts
{
    <script type="text/javascript">

        function validateFile() {
            var allowedExtension = ['csv', 'xlsx'];
            var fileExtension = document.getElementById('csv').value.split('.').pop().toLowerCase();
            var isValidFile = false;

            for (var index in allowedExtension) {

                if (fileExtension === allowedExtension[index]) {
                    isValidFile = true;
                    break;
                }
            }

            if (!isValidFile) {
                alert('Las extensiones permitidas son : *.' + allowedExtension.join(', *.'));
                document.getElementById('csv').value = "";
            }

            return isValidFile;
        }
    </script>
}